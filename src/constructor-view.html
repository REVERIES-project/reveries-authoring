<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="./styles/common-styles.html">
<link rel="import" href="./element/unit-activity/unit-activity-constructor.html">
<dom-module id="constructor-view">
    <template>
        <style include="common-styles">
        </style>
        <div  class="card">
            <div class="topLevelInfo">
                <h2>Unités de jeu</h2>
                <div>
                    Les unités de jeux sont les composants
                    <b>les plus complexes dans MOGGLE.</b> Une unité de jeu définit, suivant un pattern préétabli, une activité
                    complète.
                    La création d'une unité de jeu se fait suivant plusieurs étapes, chaque étape étant représenté par un cadre ci dessous.
                    <ul>
                        <li>Choix d'une page de départ</li>
                        <li>Sélection du POI et du mode de guidance</li>
                        <li>Sélection (optionnelle) d'un item d'inventaire acquis durant l'unité</li>
                        <li>Sélection des activités proposées à l'arrivée au POI</li>
                        <li>Choix (optionnel) d'une page de feedback/synthèse terminant l'unité de jeu</li>
                    </ul>

                </div>
            </div>
            </div>
            <unit-activity-constructor id="unitGame"></unit-activity-constructor>
            <div style="padding:10px;" class="card">
                <list-generic-resource share-url='/unitgame' id='unitgameList' resource-type='unitgame' url='/unitgame'></list-generic-resource>
            </div>
    </template>
    <script>
        Polymer({

            is: 'constructor-view',
            ready: function () {
                //  this.$.gameResource.addEventListener('addItem',this.addNewItem.bind(this))
                this.$.unitGame.addEventListener('resource-operation', this.updateMedia.bind(this))
                this.$.unitgameList.addEventListener('resource-operation', this.updateMedia.bind(this))

            },
            updateMedia: function (message) {
                switch (message.detail.info.operation) {
                    case 'create':
                        this.$.unitgameList.requestElements()
                        break
                    case 'update':
                        this.$.unitgameList.requestElements()
                        break
                    case 'edit':
                        this.$.unitGame.edit(message.detail.info.resource)
                        break

                    case 'delete':
                        this.$.unitgameList.requestElements()
                        break

                }
            },
            clearList: function () {
                this.$.uploader.clear();
            }
        });
    </script>
</dom-module>