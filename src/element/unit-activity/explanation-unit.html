<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="imteport" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../remove-ressource/remove-ressource.html">
<link rel=import href="../media-viewer/media-viewer-dialog.html">
<link rel="import" href="../../../bower_components/akc-meta/akc-meta.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<dom-module id="explanation-unit">
    <template>
        <style is="custom-style">
        .cafe-header {
            @apply(--paper-font-headline);
        }
        
        .cafe-light {
            color: var(--paper-grey-600);
        }
        
        .cafe-location {
            float: right;
            font-size: 15px;
            vertical-align: middle;
        }
        
        .cafe-reserve {
            color: var(--google-blue-500);
        }
        
        .image {
            width: 200px;
            height: 250px;
            float: right;
        }
        
        iron-icon.star {
            --iron-icon-width: 16px;
            --iron-icon-height: 16px;
            color: var(--paper-amber-500);
        }
        
        iron-icon.star:last-of-type {
            color: var(--paper-grey-500);
        }
        </style>
        <akc-meta-query key="status" value="{{status}}"></akc-meta-query>
        <iron-ajax id="ajaxLoader" url="{{url}}" handle-as="json" last-response="{{items}}"></iron-ajax>
        <paper-card alt="Donuts">
            <div class="card-content">
                <div class="cafe-header">
                    <h3 label="Unit game short description">Mobile Game description</h3>
                    <img on-click="showDialog" src="/file/{{startImage}}" class="image">
                    <media-viewer-dialog currentid="{{startImage    }}" id="suspect"></media-viewer-dialog>
                    <div class="cafe-location cafe-light">
                        <iron-icon icon="communication:location-on"></iron-icon>
                    </div>
                </div>
                <div class="cafe-rating">
                    <iron-icon class="star" icon="star"></iron-icon>
                    <iron-icon class="star" icon="star"></iron-icon>
                    <iron-icon class="star" icon="star"></iron-icon>
                    <iron-icon class="star" icon="star"></iron-icon>
                    <iron-icon class="star" icon="star"></iron-icon>
                </div>
                <p>
                    <paper-input style="display:flex" value="{{explanationGeneric}}" label="Explication des objectifs du MLG"></paper-input>
                </p>
                <p class="cafe-light">
                    <paper-input style="display:flex" value="{{activityDescription}}" label="Description de l'activité réalisé"> </paper-input>
                </p>
            </div>
            <div style="float:left" class="card-actions">
                <p>Interactions during the game</p>
                <div class="horizontal justified">
                    <paper-icon-button icon="icons:event"></paper-icon-button>
                    <paper-button>QR-Code</paper-button>
                    <paper-button>Photo</paper-button>
                    <paper-button>Photobooth</paper-button>
                </div>
                <paper-button class="cafe-reserve">Reserve</paper-button>
            </div>
        </paper-card>
    </template>
    <script>
    (function() {
        'use strict';

        Polymer({
            is: 'explanation-unit',

            ready: function() {
                 this.set('callback', function() {
                    this.$.ajaxLoader.generateRequest();
                }.bind(this));

            },
            showDialog: function() {
                this.$.suspect.openDialog();
            },

            itemInArray: function(item) {
                for (var i = 0; i < this.itemsOnMap.length; i++) {
                    if (this.itemsOnMap[i] == item._id) {
                        return true;
                    }
                }
                return false;
            },
            itemIndex: function(item) {
                for (var i = 0; i < this.itemsOnMap.length; i++) {
                    if (this.itemsOnMap[i] == item._id) {
                        return i;
                    }
                }
                return -1;

            },
            observers: [
                'statusChanged(status)',
                'newpoiChanged(newpoi)'
            ],
            statusChanged: function(status) {
                if (status.logged) {
                    this.$.ajaxLoader.generateRequest();

                }
            },
            properties: {
                startImage: {
                    type: String,
                    notify: true,
                    reflectToAttribute: true,
                    default: "57b6f0ca0c86c10927563ea1h"
                },
                callbackfunction: {
                    type: Object,
                },
                explanationGeneric: {
                    type: String,
                    notify: true,
                    reflectToAttribute: true
                },
                activityDescription: {
                    type: String,
                    notify: true,
                    reflectToAttribute: true
                }
            }
        });
    })();
    </script>
</dom-module>
