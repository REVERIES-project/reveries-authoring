<link rel="import" href="./list-generic-resource.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<style>
.flexible {
    display: inline-flex;
    flex-wrap: wrap;
}
</style>
<dom-module id="resource-picker-dialog">
    <template>
        <paper-dialog dynamic-align style="overflow: auto;left: 269px;right: 87px;min-width: 500px;/* width: 100%; */height: 50%;outline: none;z-index: 103;position: fixed;top: 132.667px;" id="selectorDialog">
                <paper-tabs selected="{{selected}}" scrollable>
                    <template is="dom-if" if="{{image}}">
                        <paper-tab>Images</paper-tab>
                    </template>
                    <template is="dom-if" if="{{page}}">
                        <paper-tab>Documents multim√©dias</paper-tab>
                    </template>
                    <template is="dom-if" if="{{inventory}}">
                        <paper-tab>Objets d'inventaire</paper-tab>
                    </template>
                    <template is="dom-if" if="{{badge}}">
                        <paper-tab>Badges</paper-tab>
                    </template>
                    <template is="dom-if" if="{{video}}">
                        <paper-tab>Video</paper-tab>
                    </template>
                    <template is="dom-if" if="{{poi}}">
                        <paper-tab>POI</paper-tab>
                    </template>
                    <template is="dom-if" if="{{mcq}}">
                        <paper-tab>QCM</paper-tab>
                    </template>
                    <template is="dom-if" if="{{freetext}}">
                        <paper-tab>Questions libres</paper-tab>
                    </template>
                </paper-tabs>
                <iron-pages id="resourcePicker" selected="{{selected}}">
                    <template is="dom-if" if="{{image}}" restamp>
                        <div>
                            <list-generic-resource picker share-url='/listUserImages' id='image' resource-id='{{mediaId}}' resource-type='image' url='/listUserImages'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{page}}" restamp>
                        <div>
                            <list-generic-resource picker share-url='/staticmedia' id='staticmedia' resource-type='page' url='/staticmedia'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{inventory}}" restamp>
                        <div>
                            <list-generic-resource picker share-url='/inventory' id='inventoryList' resource-type='inventory' url='/inventory'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{poi}}">
                        <div>
                            <list-generic-resource picker share-url='/poi' id='poiList' resource-type='poi' url='/poi'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{mcq}}">
                        <div>
                            <list-generic-resource picker share-url='/mcq' id='mcqList' resource-type='mcq' url='/mcq'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{freetext}}">
                        <div>
                            <list-generic-resource picker share-url='/freetextactivity' id='freetextList' resource-type='freetext' url='/freetextActivity'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{badge}}">
                        <div>
                            <list-generic-resource picker share-url='/badge' id='badge' resource-type='badge' url='/badge'></list-generic-resource>
                            <div class="buttons">
                                <paper-button raised style="background-color: lightgreen" on-click="setValues" dialog-confirm>OK</paper-button>
                            </div>
                        </div>
                    </template>
                </iron-pages>
        </paper-dialog>
    </template>
    <script>
    (function() {
        'use strict';
        Polymer({
            is: 'resource-picker-dialog',
            ready: function() {
                this.$.selectorDialog.addEventListener('resourcePickedFromList', this.resourcePicked.bind(this))
            },
            setValues: function() {

            },
            open: function() {


                this.$.selectorDialog.open();
                var res = Polymer.dom(this.root).querySelectorAll('list-generic-resource')
                for (var i = 0; i < res.length; i++) {
                    res[i].requestElements()
                }
            },
            resourcePicked: function(evt) {
                if (evt && evt.detail && evt.detail.resourceType && evt.detail.resourceItem && this.resourceViewer) {

                    this.fire('resourcePicked', { resourceType: evt.detail.resourceType, resourceItem: evt.detail.resourceItem, resourceViewer: this.resourceViewer })
                    return
                }
                if (evt && evt.detail && evt.detail.resourceType && evt.detail.resourceItem) {

                    this.fire('resourcePicked', { resourceType: evt.detail.resourceType, resourceItem: evt.detail.resourceItem })
                    return
                }

            },
            properties: {

                opened: {
                    type: Boolean,
                    value: false,
                },
                inventory: {
                    type: Boolean,
                    value: false,
                },

                poi: {
                    type: Boolean,
                    notify: true,
                },
                badge: {
                    type: Boolean,
                    notify: true,
                },

                mcq: {
                    type: Boolean,
                    notify: true,
                },
                image: {
                    type: Boolean,
                    notify: true,
                },
                video: {
                    type: Boolean,
                    notify: true,
                },
                page: {
                    type: Boolean,
                    notify: true,
                },
                freetext: {
                    type: Boolean,
                    notify: true,
                },

                mediaId: {
                    type: String,
                    notify: true,
                    value: null,
                    reflectToAttribute: true,
                },
                mediaName: {
                    type: String,
                    notify: true,
                    value: null,
                    reflectToAttribute: true,
                },
                resourceViewer: {
                    type: String,
                    notify: true,
                },
            }
        });
    })();
    </script>
</dom-module>